<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QUIZ PROFUNDO | 12 Pombagiras</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --sangue: #8b0000;
            --ouro: #ffd700;
            --vinho: #4a0404;
            --roxo-profundo: #2a0a44;
            --preto-veludo: #0a0a0a;
            --vermelho-vivo: #c2185b;
            --dourado-brilhante: #ffcc00;
            --rosa-poder: #ff1493;
            --azul-noite: #0d1b2a;
            --verde-ancestral: #1b4332;
        }
        
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--preto-veludo) 0%, var(--roxo-profundo) 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(139, 0, 0, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(255, 20, 147, 0.08) 0%, transparent 50%);
            z-index: -1;
            animation: pulseBackground 20s ease-in-out infinite alternate;
        }
        
        @keyframes pulseBackground {
            0% { opacity: 0.5; }
            100% { opacity: 0.8; }
        }
        
        .container { 
            max-width: 900px; 
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }
        
        /* HEADER DRAM√ÅTICO */
        .header {
            text-align: center;
            padding: 40px 30px;
            background: rgba(10, 10, 10, 0.7);
            border-radius: 20px;
            margin-bottom: 30px;
            border: 3px solid transparent;
            background-clip: padding-box;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5),
                        inset 0 0 0 1px rgba(255, 215, 0, 0.2);
            animation: borderGlow 3s infinite alternate;
        }
        
        @keyframes borderGlow {
            0% { 
                border-color: rgba(139, 0, 0, 0.3);
                box-shadow: 0 10px 30px rgba(139, 0, 0, 0.3),
                            inset 0 0 0 1px rgba(255, 215, 0, 0.2);
            }
            100% { 
                border-color: rgba(255, 215, 0, 0.5);
                box-shadow: 0 10px 30px rgba(255, 215, 0, 0.2),
                            inset 0 0 0 1px rgba(255, 20, 147, 0.3);
            }
        }
        
        .header h1 {
            color: var(--dourado-brilhante);
            margin-bottom: 15px;
            font-size: 3.2rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5),
                         0 0 20px rgba(139, 0, 0, 0.3);
            animation: titleGlow 2s ease-in-out infinite alternate;
            font-weight: 900;
            background: linear-gradient(45deg, var(--dourado-brilhante), var(--rosa-poder));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        @keyframes titleGlow {
            0% { text-shadow: 0 0 10px rgba(255, 215, 0, 0.5), 0 0 20px rgba(139, 0, 0, 0.3); }
            100% { text-shadow: 0 0 15px rgba(255, 20, 147, 0.6), 0 0 25px rgba(255, 215, 0, 0.4); }
        }
        
        .header p {
            color: rgba(255, 255, 255, 0.85);
            font-size: 1.3rem;
            font-style: italic;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        .header .subtitulo {
            color: var(--ouro);
            font-size: 1.1rem;
            margin-top: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        /* BOT√ÉO DE IN√çCIO */
        .iniciar-container {
            text-align: center;
            margin: 40px 0;
        }
        
        .btn-iniciar {
            background: linear-gradient(45deg, var(--sangue), var(--vermelho-vivo));
            color: white;
            border: none;
            padding: 20px 50px;
            border-radius: 50px;
            font-size: 1.4rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            box-shadow: 0 5px 15px rgba(194, 24, 91, 0.4);
        }
        
        .btn-iniciar:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 25px rgba(194, 24, 91, 0.6);
            background: linear-gradient(45deg, var(--vermelho-vivo), var(--sangue));
        }
        
        .btn-iniciar:active {
            transform: translateY(-2px) scale(1.02);
        }
        
        .btn-iniciar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.7s;
        }
        
        .btn-iniciar:hover::after {
            left: 100%;
        }
        
        /* QUIZ BOX - PERGUNTAS */
        .quiz-box {
            background: rgba(20, 20, 20, 0.85);
            padding: 35px;
            border-radius: 20px;
            border: 2px solid rgba(255, 215, 0, 0.2);
            margin-bottom: 25px;
            display: none;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.6s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .pergunta-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.3);
        }
        
        .dificuldade {
            background: rgba(255, 215, 0, 0.15);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            color: var(--ouro);
            font-weight: bold;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        .pergunta {
            font-size: 1.5rem;
            margin-bottom: 35px;
            line-height: 1.6;
            color: #ffffff;
            font-weight: 500;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            border-left: 4px solid var(--rosa-poder);
        }
        
        .opcoes { 
            display: grid; 
            gap: 15px; 
            margin: 30px 0; 
        }
        
        .opcao {
            background: rgba(40, 40, 40, 0.7);
            padding: 22px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid transparent;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
            overflow: hidden;
        }
        
        .opcao::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: var(--ouro);
            transform: scaleY(0);
            transition: transform 0.3s;
        }
        
        .opcao:hover {
            background: rgba(60, 60, 60, 0.9);
            transform: translateX(5px);
            border-color: rgba(255, 215, 0, 0.3);
        }
        
        .opcao:hover::before {
            transform: scaleY(1);
        }
        
        .opcao-numero {
            background: rgba(255, 215, 0, 0.2);
            color: var(--ouro);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
            border: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        .opcao.selecionada {
            background: rgba(30, 60, 30, 0.7);
            border-color: #4CAF50;
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.3);
        }
        
        .opcao.selecionada .opcao-numero {
            background: #4CAF50;
            color: white;
        }
        
        .opcao.selecionada::before {
            background: #4CAF50;
            transform: scaleY(1);
        }
        
        .opcao.errada {
            background: rgba(100, 30, 30, 0.7);
            border-color: #f44336;
            animation: shake 0.5s;
        }
        
        .opcao.errada .opcao-numero {
            background: #f44336;
            color: white;
        }
        
        .opcao.errada::before {
            background: #f44336;
            transform: scaleY(1);
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .opcao.correta {
            background: rgba(30, 70, 30, 0.7);
            border-color: #4CAF50;
            animation: pulseCorrect 0.5s;
        }
        
        .opcao.correta .opcao-numero {
            background: #4CAF50;
            color: white;
        }
        
        .opcao.correta::before {
            background: #4CAF50;
            transform: scaleY(1);
        }
        
        @keyframes pulseCorrect {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .btn-proximo {
            background: linear-gradient(45deg, var(--roxo-profundo), var(--sangue));
            color: white;
            border: none;
            padding: 18px 40px;
            border-radius: 12px;
            font-size: 1.2rem;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            font-weight: bold;
            letter-spacing: 1px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .btn-proximo:hover:not(:disabled) {
            background: linear-gradient(45deg, var(--sangue), var(--roxo-profundo));
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(139, 0, 0, 0.4);
        }
        
        .btn-proximo:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .progresso-container {
            margin-top: 25px;
            text-align: center;
        }
        
        .barra-progresso {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            margin-bottom: 10px;
            overflow: hidden;
        }
        
        .progresso {
            height: 100%;
            background: linear-gradient(90deg, var(--sangue), var(--rosa-poder));
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 4px;
        }
        
        .contador-quiz {
            display: flex;
            justify-content: space-between;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
        }
        
        /* RESULTADO - REVELA√á√ÉO DRAM√ÅTICA */
        .resultado {
            background: linear-gradient(135deg, rgba(20, 20, 20, 0.95), rgba(42, 10, 68, 0.95));
            padding: 40px;
            border-radius: 25px;
            border: 3px solid transparent;
            display: none;
            text-align: center;
            backdrop-filter: blur(15px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5);
            animation: revealResult 1s ease-out;
            position: relative;
            overflow: hidden;
        }
        
        @keyframes revealResult {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        .resultado::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--sangue), var(--ouro), var(--rosa-poder));
            animation: rainbowBorder 3s linear infinite;
        }
        
        @keyframes rainbowBorder {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        
        .titulo-resultado {
            color: var(--dourado-brilhante);
            margin-bottom: 15px;
            font-size: 2.2rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .nome-pombagira {
            color: var(--rosa-poder);
            font-size: 3.5rem;
            margin: 20px 0;
            font-weight: 900;
            text-shadow: 0 0 15px rgba(255, 20, 147, 0.6);
            animation: glowName 2s ease-in-out infinite alternate;
            background: linear-gradient(45deg, var(--rosa-poder), var(--dourado-brilhante));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        @keyframes glowName {
            0% { text-shadow: 0 0 10px rgba(255, 20, 147, 0.6); }
            100% { text-shadow: 0 0 20px rgba(255, 215, 0, 0.7), 0 0 30px rgba(255, 20, 147, 0.5); }
        }
        
        .imagem-pombagira-container {
            width: 280px;
            height: 280px;
            margin: 25px auto;
            border-radius: 50%;
            overflow: hidden;
            border: 5px solid transparent;
            background: linear-gradient(45deg, var(--sangue), var(--ouro), var(--rosa-poder)) border-box;
            padding: 5px;
            box-shadow: 0 0 30px rgba(139, 0, 0, 0.5);
            animation: floatImage 6s ease-in-out infinite;
        }
        
        @keyframes floatImage {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .imagem-pombagira {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }
        
        .frase-pombagira {
            font-size: 1.5rem;
            color: var(--ouro);
            font-style: italic;
            margin: 25px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border-left: 4px solid var(--rosa-poder);
            position: relative;
            line-height: 1.6;
        }
        
        .frase-pombagira::before {
            content: '"';
            font-size: 4rem;
            color: rgba(255, 215, 0, 0.3);
            position: absolute;
            top: -15px;
            left: 15px;
        }
        
        .frase-pombagira::after {
            content: '"';
            font-size: 4rem;
            color: rgba(255, 215, 0, 0.3);
            position: absolute;
            bottom: -35px;
            right: 15px;
        }
        
        .detalhes-pombagira {
            background: rgba(30, 30, 30, 0.7);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            text-align: left;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .detalhes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .detalhe-item {
            padding: 12px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            border-left: 3px solid var(--rosa-poder);
        }
        
        .detalhe-label {
            color: var(--ouro);
            font-weight: bold;
            font-size: 0.95rem;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .detalhe-valor {
            color: #ffffff;
            font-size: 1.05rem;
        }
        
        .pontuacao-final {
            font-size: 1.4rem;
            color: var(--dourado-brilhante);
            margin: 25px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            display: inline-block;
        }
        
        .acoes-resultado {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn-acao {
            padding: 16px 35px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-width: 200px;
            font-size: 1.1rem;
            border: 2px solid transparent;
        }
        
        .btn-reiniciar {
            background: linear-gradient(45deg, var(--sangue), var(--vermelho-vivo));
            color: white;
        }
        
        .btn-reiniciar:hover {
            background: linear-gradient(45deg, var(--vermelho-vivo), var(--sangue));
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(194, 24, 91, 0.4);
        }
        
        .btn-compartilhar {
            background: linear-gradient(45deg, var(--roxo-profundo), #6a11cb);
            color: white;
        }
        
        .btn-compartilhar:hover {
            background: linear-gradient(45deg, #6a11cb, var(--roxo-profundo));
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(106, 17, 203, 0.4);
        }
        
        /* CONTADOR DE VISITAS */
        .contador-acessos {
            position: fixed;
            bottom: 25px;
            right: 25px;
            background: rgba(10, 10, 10, 0.8);
            backdrop-filter: blur(10px);
            color: var(--ouro);
            padding: 10px 20px;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 300;
            letter-spacing: 0.5px;
            opacity: 0.7;
            transition: all 0.3s;
            z-index: 1000;
            border: 1px solid rgba(255, 215, 0, 0.3);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 160px;
        }
        
        .contador-acessos:hover {
            opacity: 1;
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }
        
        .contador-icone {
            font-size: 1.2rem;
            color: var(--rosa-poder);
        }
        
        .contador-numero {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--dourado-brilhante);
            text-shadow: 0 0 5px rgba(255, 215, 0, 0.3);
        }
        
        /* LOADING */
        .loading {
            text-align: center;
            padding: 60px 30px;
            font-size: 1.3rem;
            display: none;
        }
        
        .spinner {
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid var(--rosa-poder);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1.5s linear infinite;
            margin: 30px auto;
            box-shadow: 0 0 20px rgba(255, 20, 147, 0.3);
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .mensagem-loading {
            color: var(--ouro);
            font-size: 1.2rem;
            margin-top: 20px;
            font-style: italic;
        }
        
        /* ERROR */
        .error {
            background: linear-gradient(45deg, rgba(139, 0, 0, 0.2), rgba(244, 67, 54, 0.2));
            color: #ff8888;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
            display: none;
            border-left: 4px solid #f44336;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* RESPONSIVO */
        @media (max-width: 768px) {
            .header h1 { font-size: 2.2rem; }
            .header p { font-size: 1.1rem; }
            .nome-pombagira { font-size: 2.5rem; }
            .imagem-pombagira-container { width: 220px; height: 220px; }
            .pergunta { font-size: 1.3rem; }
            .opcao { padding: 18px; }
            .detalhes-grid { grid-template-columns: 1fr; }
            .acoes-resultado { flex-direction: column; }
            .btn-acao { min-width: 100%; }
            .contador-acessos { 
                bottom: 15px; 
                right: 15px; 
                padding: 8px 15px;
                min-width: 140px;
            }
        }
        
        @media (max-width: 480px) {
            .header { padding: 25px 20px; }
            .header h1 { font-size: 1.8rem; }
            .quiz-box, .resultado { padding: 25px 20px; }
            .btn-iniciar { padding: 16px 35px; font-size: 1.2rem; }
            .imagem-pombagira-container { width: 180px; height: 180px; }
        }
        
        /* ANIMA√á√ÉO DE PART√çCULAS */
        .particulas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        
        .particula {
            position: absolute;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 50%;
            animation: floatParticula linear infinite;
        }
        
        @keyframes floatParticula {
            to { transform: translateY(-100vh); }
        }
    </style>
</head>
<body>
    <!-- PART√çCULAS DE FUNDO -->
    <div class="particulas" id="particulas"></div>
    
    <!-- CONTADOR DE VISITAS -->
    <div class="contador-acessos" id="contador-acessos">
        <div class="contador-icone"><i class="fas fa-eye"></i></div>
        <div class="contador-texto">Visitas:</div>
        <div class="contador-numero" id="acesso-numero">0</div>
    </div>
    
    <div class="container">
        <!-- CABE√áALHO PRINCIPAL -->
        <div class="header">
            <h1>OR√ÅCULO DAS 12 POMBAGIRAS</h1>
            <p>Desvende os Mist√©rios Profundos das Senhoras da Noite</p>
            <p class="subtitulo">
                <i class="fas fa-moon"></i> Quiz Avan√ßado para Iniciados | 50 Perguntas de Sabedoria Oculta
            </p>
        </div>
        
        <!-- BOT√ÉO DE IN√çCIO -->
        <div class="iniciar-container" id="iniciar-container">
            <button class="btn-iniciar" onclick="iniciarQuiz()" id="btn-iniciar">
                <i class="fas fa-play-circle"></i> INICIAR JORNADA M√çSTICA
            </button>
        </div>
        
        <!-- MENSAGEM DE ERRO -->
        <div class="error" id="error-msg"></div>
        
        <!-- LOADING -->
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p class="mensagem-loading" id="mensagem-loading">Consultando o Grim√≥rio Ancestral...</p>
        </div>
        
        <!-- QUIZ -->
        <div class="quiz-box" id="quiz-box">
            <div class="pergunta-header">
                <div class="dificuldade" id="dificuldade">N√çVEL: <span id="nivel-atual">1</span></div>
                <div class="pontos" id="pontos-display">PONTOS: <span id="pontos">0</span></div>
            </div>
            
            <div class="pergunta" id="pergunta"></div>
            
            <div class="opcoes" id="opcoes"></div>
            
            <button class="btn-proximo" id="btn-proximo" onclick="proximaPergunta()" disabled>
                <span id="btn-texto">PR√ìXIMA PERGUNTA</span>
                <i class="fas fa-arrow-right" id="btn-icone"></i>
            </button>
            
            <div class="progresso-container">
                <div class="barra-progresso">
                    <div class="progresso" id="progresso"></div>
                </div>
                <div class="contador-quiz">
                    <span id="contador-pergunta">Pergunta 1/12</span>
                    <span id="tempo-restante"></span>
                </div>
            </div>
        </div>
        
        <!-- RESULTADO -->
        <div class="resultado" id="resultado">
            <h2 class="titulo-resultado">A GIRA SE FECHA PARA VOC√ä</h2>
            <h1 class="nome-pombagira" id="nome-pombagira">MARIA PADILHA</h1>
            
            <div class="imagem-pombagira-container">
                <img class="imagem-pombagira" id="imagem-pombagira" src="" alt="Pombagira">
            </div>
            
            <div class="frase-pombagira" id="frase-pombagira">
                "Na encruzilhada do destino, eu comando!"
            </div>
            
            <div class="detalhes-pombagira">
                <h3 style="color: var(--ouro); margin-bottom: 20px;">
                    <i class="fas fa-star"></i> SEUS ATRIBUTOS SAGRADOS
                </h3>
                <div class="detalhes-grid" id="detalhes-pombagira">
                    <!-- Preenchido por JavaScript -->
                </div>
            </div>
            
            <div class="pontuacao-final">
                <i class="fas fa-trophy"></i> SUA PONTUA√á√ÉO: <span id="pontuacao-final">0</span> PONTOS
            </div>
            
            <div class="acoes-resultado">
                <button class="btn-acao btn-reiniciar" onclick="reiniciarQuiz()">
                    <i class="fas fa-redo"></i> NOVA JORNADA
                </button>
                <button class="btn-acao btn-compartilhar" onclick="compartilharResultado()">
                    <i class="fas fa-share-alt"></i> COMPARTILHAR
                </button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // CONFIGURA√á√ïES
        // ============================================
        const SUPABASE_URL = 'https://rbygxkbewzknvjjhxdvw.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJieWd4a2Jld3prbnZqamh4ZHZ3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwMDcxNjQsImV4cCI6MjA4MTU4MzE2NH0.YrHF9HEGo6yv9MyNsPzFgBhaAB1DRh2SLU8f7L6s1nY';
        
        // URLs das imagens das Pombagiras
        const IMAGENS_POMBAGIRAS = {
            'Maria Padilha': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/maria_padilha.png',
            'Maria Mulambo': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/maria_mulambo.png',
            'Maria Quit√©ria': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/maria_quiteria.png',
            'Rosa Caveira': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/rosa_caveira.png',
            'Dama da Noite': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/dama_noite.png',
            'Sete Saias': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/sete_saias.png',
            'Pombagira Cigana': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/cigana.png',
            'Maria Navalha': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/maria_navalha.png',
            'Pombagira da Praia': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/praia.png',
            'Maria Farrapo': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/maria_farrapo.png',
            'Pombagira Menina': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/menina.png',
            'Pombagira da Figueira': 'https://raw.githubusercontent.com/alexialuzdeferro/misterio-das-giras/refs/heads/main/figueira.png'
        };

        // ============================================
        // ESTADO DO QUIZ
        // ============================================
        const estado = {
            perguntas: [],
            perguntaAtual: 0,
            pontos: 0,
            pombagiras: [],
            respostas: [],
            respostaSelecionada: null,
            respostaCorreta: null,
            quizIniciado: false,
            tempoInicio: null,
            modoDemonstracao: false,
            pombagiraResultado: null,
            dadosPombagira: null
        };

        // ============================================
        // ANIMA√á√ïES DE PART√çCULAS
        // ============================================
        function criarParticulas() {
            const particulasContainer = document.getElementById('particulas');
            const quantidade = 30;
            
            for (let i = 0; i < quantidade; i++) {
                const particula = document.createElement('div');
                particula.classList.add('particula');
                
                const tamanho = Math.random() * 10 + 5;
                const posX = Math.random() * 100;
                const duracao = Math.random() * 20 + 10;
                const atraso = Math.random() * 5;
                
                particula.style.width = `${tamanho}px`;
                particula.style.height = `${tamanho}px`;
                particula.style.left = `${posX}%`;
                particula.style.animationDuration = `${duracao}s`;
                particula.style.animationDelay = `${atraso}s`;
                particula.style.opacity = Math.random() * 0.3 + 0.1;
                
                particulasContainer.appendChild(particula);
            }
        }

        // ============================================
        // INICIALIZA√á√ÉO DO QUIZ
        // ============================================
        async function iniciarQuiz() {
            console.log("üåô Iniciando Or√°culo das 12 Pombagiras...");
            
            // Esconder bot√£o de in√≠cio e mostrar loading
            document.getElementById('iniciar-container').style.display = 'none';
            document.getElementById('loading').style.display = 'block';
            atualizarMensagemLoading('Conectando ao Supabase...');
            
            // Criar part√≠culas
            criarParticulas();
            
            try {
                // Registrar acesso
                await registrarAcesso();
                
                // Carregar contador
                await carregarContador();
                
                // Carregar dados do quiz
                await carregarDadosQuiz();
                
                // Esconder loading e mostrar quiz
                document.getElementById('loading').style.display = 'none';
                document.getElementById('quiz-box').style.display = 'block';
                estado.quizIniciado = true;
                estado.tempoInicio = Date.now();
                
                // Mostrar primeira pergunta
                mostrarPerguntaAtual();
                
            } catch (error) {
                console.error("‚ùå Erro ao iniciar quiz:", error);
                mostrarErro("Falha na conex√£o m√≠stica. Ativando modo de rever√™ncia...");
                usarModoDemonstracao();
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('quiz-box').style.display = 'block';
                estado.quizIniciado = true;
                estado.modoDemonstracao = true;
                estado.tempoInicio = Date.now();
                
                mostrarPerguntaAtual();
            }
        }

        function atualizarMensagemLoading(mensagem) {
            const elemento = document.getElementById('mensagem-loading');
            if (elemento) {
                elemento.textContent = mensagem;
            }
        }

        // ============================================
        // CONTADOR DE ACESSOS
        // ============================================
        async function registrarAcesso() {
            try {
                if (sessionStorage.getItem('acessoRegistradoQuiz')) {
                    console.log("‚úÖ Acesso j√° registrado nesta sess√£o");
                    return;
                }
                
                const checkResponse = await fetch(
                    SUPABASE_URL + '/rest/v1/page_views?page=eq.quiz-pombagiras&select=view_count', 
                    {
                        headers: {
                            'apikey': SUPABASE_KEY,
                            'Authorization': 'Bearer ' + SUPABASE_KEY
                        }
                    }
                );
                
                if (!checkResponse.ok) throw new Error('Erro ao verificar contador');
                
                const existingData = await checkResponse.json();
                
                if (existingData.length > 0) {
                    const currentCount = existingData[0].view_count || 0;
                    const newCount = currentCount + 1;
                    
                    const updateResponse = await fetch(
                        SUPABASE_URL + '/rest/v1/page_views?page=eq.quiz-pombagiras', 
                        {
                            method: 'PATCH',
                            headers: {
                                'apikey': SUPABASE_KEY,
                                'Authorization': 'Bearer ' + SUPABASE_KEY,
                                'Content-Type': 'application/json',
                                'Prefer': 'return=minimal'
                            },
                            body: JSON.stringify({
                                view_count: newCount,
                                updated_at: new Date().toISOString()
                            })
                        }
                    );
                    
                    if (!updateResponse.ok) throw new Error('Erro ao atualizar contador');
                    
                    console.log("‚úÖ Contador atualizado:", newCount);
                    
                } else {
                    const insertResponse = await fetch(SUPABASE_URL + '/rest/v1/page_views', {
                        method: 'POST',
                        headers: {
                            'apikey': SUPABASE_KEY,
                            'Authorization': 'Bearer ' + SUPABASE_KEY,
                            'Content-Type': 'application/json',
                            'Prefer': 'return=minimal'
                        },
                        body: JSON.stringify({
                            page: 'quiz-pombagiras',
                            view_count: 1,
                            updated_at: new Date().toISOString()
                        })
                    });
                    
                    if (!insertResponse.ok) throw new Error('Erro ao criar contador');
                    
                    console.log("‚úÖ Contador criado para quiz-pombagiras");
                }
                
                sessionStorage.setItem('acessoRegistradoQuiz', 'true');
                
            } catch (error) {
                console.warn("‚ö†Ô∏è N√£o foi poss√≠vel registrar acesso:", error.message);
            }
        }

        async function carregarContador() {
            try {
                const cachedCount = localStorage.getItem('quizVisitCount');
                const cacheTimestamp = localStorage.getItem('quizVisitCountTimestamp');
                const now = Date.now();
                
                if (cachedCount && cacheTimestamp && (now - parseInt(cacheTimestamp)) < 5 * 60 * 1000) {
                    document.getElementById('acesso-numero').textContent = cachedCount;
                    console.log("üìä Contador carregado do cache:", cachedCount);
                    
                    setTimeout(async () => {
                        await atualizarContador(true);
                    }, 1000);
                    
                    return;
                }
                
                await atualizarContador(false);
                
            } catch (error) {
                console.warn("‚ö†Ô∏è N√£o foi poss√≠vel carregar contador inicial");
                
                const cachedCount = localStorage.getItem('quizVisitCount');
                if (cachedCount) {
                    document.getElementById('acesso-numero').textContent = cachedCount + '+';
                }
            }
        }

        async function atualizarContador(useCacheFallback = false) {
            try {
                const response = await fetch(
                    SUPABASE_URL + '/rest/v1/page_views?page=eq.quiz-pombagiras&select=view_count', 
                    {
                        headers: {
                            'apikey': SUPABASE_KEY,
                            'Authorization': 'Bearer ' + SUPABASE_KEY,
                            'Cache-Control': 'max-age=300'
                        }
                    }
                );
                
                if (response.ok) {
                    const data = await response.json();
                    
                    if (data.length > 0) {
                        const count = data[0].view_count || 0;
                        
                        document.getElementById('acesso-numero').textContent = count.toLocaleString();
                        
                        localStorage.setItem('quizVisitCount', count);
                        localStorage.setItem('quizVisitCountTimestamp', Date.now());
                        
                        animarContador();
                        
                        console.log("üìä Contador atualizado do servidor:", count);
                    } else {
                        console.log("üìä Nenhum registro encontrado, criando...");
                        await registrarAcesso();
                        await atualizarContador(useCacheFallback);
                    }
                } else {
                    throw new Error('Resposta n√£o OK do servidor');
                }
            } catch (error) {
                console.warn("‚ö†Ô∏è Erro ao atualizar contador:", error.message);
                
                if (useCacheFallback) {
                    const cachedCount = localStorage.getItem('quizVisitCount');
                    if (cachedCount) {
                        document.getElementById('acesso-numero').textContent = cachedCount + '*';
                    }
                }
            }
        }

        function animarContador() {
            const contador = document.getElementById('contador-acessos');
            const numero = document.getElementById('acesso-numero');
            
            contador.style.opacity = '0.9';
            contador.style.transform = 'translateY(-5px)';
            
            numero.style.color = '#fff';
            numero.style.textShadow = '0 0 10px rgba(255, 215, 0, 0.8)';
            
            setTimeout(() => {
                contador.style.opacity = '0.7';
                contador.style.transform = 'translateY(0)';
                
                numero.style.color = '#ffd700';
                numero.style.textShadow = '0 0 5px rgba(255, 215, 0, 0.3)';
            }, 800);
        }

        // ============================================
        // CARREGAMENTO DE DADOS
        // ============================================
        async function carregarDadosQuiz() {
            console.log("üì• Carregando dados avan√ßados...");
            atualizarMensagemLoading('Consultando o Grim√≥rio das 12 Luas...');
            
            try {
                // Carregar pombagiras
                const resPombagiras = await fetch(SUPABASE_URL + '/rest/v1/pombagiras?select=*', {
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': 'Bearer ' + SUPABASE_KEY
                    }
                });
                
                if (!resPombagiras.ok) throw new Error('Erro ao carregar pombagiras');
                estado.pombagiras = await resPombagiras.json();
                console.log("‚úÖ Pombagiras carregadas:", estado.pombagiras.length);
                
                // Carregar perguntas avan√ßadas
                atualizarMensagemLoading('Sintonizando com as 50 Perguntas da Sabedoria...');
                const resPerguntas = await fetch(SUPABASE_URL + '/rest/v1/perguntas?select=*', {
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': 'Bearer ' + SUPABASE_KEY
                    }
                });
                
                if (!resPerguntas.ok) throw new Error('Erro ao carregar perguntas');
                
                const todasPerguntas = await resPerguntas.json();
                
                // Embaralhamento complexo
                estado.perguntas = embaralharPerguntasComplexo(todasPerguntas);
                
                console.log("‚úÖ 50 perguntas avan√ßadas carregadas e embaralhadas");
                
            } catch (error) {
                console.error("‚ùå Erro ao carregar dados:", error);
                throw error;
            }
        }

        function embaralharPerguntasComplexo(perguntas) {
            console.log("üé≤ Embaralhando perguntas com algoritmo complexo...");
            
            // 1. Divide por n√≠vel de dificuldade
            const niveis = {
                1: perguntas.filter(p => p.nivel_dificuldade === 1),
                2: perguntas.filter(p => p.nivel_dificuldade === 2),
                3: perguntas.filter(p => p.nivel_dificuldade === 3),
                4: perguntas.filter(p => p.nivel_dificuldade === 4),
                5: perguntas.filter(p => p.nivel_dificuldade === 5)
            };
            
            // 2. Sorteia propor√ß√£o baseada na hora do dia (muda sempre)
            const hora = new Date().getHours();
            const proporcoes = [
                { nivel: 5, qtd: Math.floor(Math.random() * 3) + (hora > 18 ? 3 : 1) },
                { nivel: 4, qtd: Math.floor(Math.random() * 4) + 2 },
                { nivel: 3, qtd: Math.floor(Math.random() * 5) + 3 },
                { nivel: 2, qtd: Math.floor(Math.random() * 6) + 2 },
                { nivel: 1, qtd: Math.floor(Math.random() * 4) + 1 }
            ];
            
            // 3. Seleciona perguntas de cada n√≠vel
            let selecionadas = [];
            proporcoes.forEach(prop => {
                const disponiveis = niveis[prop.nivel];
                const embaralhadas = [...disponiveis].sort(() => Math.random() - 0.5);
                selecionadas.push(...embaralhadas.slice(0, Math.min(prop.qtd, disponiveis.length)));
            });
            
            // 4. Embaralha a ordem final
            selecionadas = selecionadas.sort(() => Math.random() - 0.5);
            
            // 5. Garante 12 perguntas
            if (selecionadas.length > 12) {
                selecionadas = selecionadas.slice(0, 12);
            }
            
            // 6. Embaralha op√ß√µes dentro de cada pergunta
            selecionadas.forEach(pergunta => {
                const opcoesComIndices = pergunta.opcoes.map((opcao, idx) => ({ opcao, idx }));
                const embaralhadas = opcoesComIndices.sort(() => Math.random() - 0.5);
                
                // Atualiza op√ß√µes e resposta correta
                pergunta.opcoes = embaralhadas.map(item => item.opcao);
                const novaPosicao = embaralhadas.findIndex(item => item.idx === pergunta.resposta_correta - 1);
                pergunta.resposta_correta = novaPosicao + 1;
            });
            
            console.log(`‚úÖ ${selecionadas.length} perguntas selecionadas com complexidade vari√°vel`);
            return selecionadas;
        }

        function usarModoDemonstracao() {
            console.log("üîÑ Ativando modo de demonstra√ß√£o...");
            
            estado.pombagiras = [
                {
                    id: 1,
                    nome: "Maria Padilha",
                    descricao: "Rainha das Encruzilhadas, senhora do comando e da sedu√ß√£o.",
                    comandos: "Comando/Realeza",
                    dia_reverencia: "Sexta-feira",
                    cores: ["Vermelho", "Dourado", "Preto"],
                    imagem_url: IMAGENS_POMBAGIRAS['Maria Padilha'],
                    frase_assinatura: "Na encruzilhada do destino, eu comando!"
                },
                {
                    id: 2,
                    nome: "Maria Quit√©ria", 
                    descricao: "Pombagira guerreira da prote√ß√£o e justi√ßa.",
                    comandos: "Guerra/Prote√ß√£o",
                    dia_reverencia: "Ter√ßa-feira",
                    cores: ["Vermelho", "Marrom", "Preto"],
                    imagem_url: IMAGENS_POMBAGIRAS['Maria Quit√©ria'],
                    frase_assinatura: "Por onde passo, fa√ßo justi√ßa e defendo os fracos!"
                }
            ];
            
            estado.perguntas = [
                {
                    id: 1,
                    pergunta: "Qual conceito da filosofia oriental se assemelha √† atua√ß√£o de Rosa Caveira nos processos de transforma√ß√£o?",
                    opcoes: ["Karma", "Dharma", "Samsara", "Nirvana"],
                    resposta_correta: 3,
                    nivel_dificuldade: 5,
                    explicacao: "Samsara (ciclo de morte e renascimento) reflete seu trabalho com ciclos de fim e recome√ßo."
                },
                {
                    id: 2, 
                    pergunta: "Qual elemento N√ÉO est√° presente no 'Trabalho das 7 Rosas' consagrado a Maria Padilha?",
                    opcoes: ["Mel", "Pimenta-da-costa", "Canela em p√≥", "A√ß√∫car mascavo"],
                    resposta_correta: 4,
                    nivel_dificuldade: 4,
                    explicacao: "O a√ß√∫car mascavo √© mais associado a Oxum. O trabalho tradicional usa mel (do√ßura), pimenta (for√ßa) e canela (aceleramento)."
                }
            ];
            
            while (estado.perguntas.length < 12) {
                estado.perguntas.push(...estado.perguntas.slice(0, 2));
            }
            estado.perguntas = estado.perguntas.slice(0, 12);
        }

        // ============================================
        // EXIBI√á√ÉO DE PERGUNTAS
        // ============================================
        function mostrarPerguntaAtual() {
            if (estado.perguntaAtual >= estado.perguntas.length) {
                finalizarQuiz();
                return;
            }
            
            const pergunta = estado.perguntas[estado.perguntaAtual];
            
            // Resetar estado da pergunta
            estado.respostaSelecionada = null;
            estado.respostaCorreta = null;
            
            // Atualizar interface
            document.getElementById('pergunta').textContent = pergunta.pergunta;
            document.getElementById('nivel-atual').textContent = pergunta.nivel_dificuldade;
            document.getElementById('contador-pergunta').textContent = 
                `Pergunta ${estado.perguntaAtual + 1}/${estado.perguntas.length}`;
            document.getElementById('pontos').textContent = estado.pontos;
            document.getElementById('btn-proximo').disabled = true;
            document.getElementById('btn-texto').textContent = estado.perguntaAtual === estado.perguntas.length - 1 ? 'VER RESULTADO' : 'PR√ìXIMA PERGUNTA';
            
            // Atualizar barra de progresso
            const progresso = ((estado.perguntaAtual + 1) / estado.perguntas.length) * 100;
            document.getElementById('progresso').style.width = `${progresso}%`;
            
            // Criar op√ß√µes
            const opcoesDiv = document.getElementById('opcoes');
            opcoesDiv.innerHTML = '';
            
            pergunta.opcoes.forEach((opcao, index) => {
                const div = document.createElement('div');
                div.className = 'opcao';
                div.innerHTML = `
                    <div class="opcao-numero">${String.fromCharCode(65 + index)}</div>
                    <div class="opcao-texto">${opcao}</div>
                `;
                div.onclick = () => selecionarOpcao(index);
                opcoesDiv.appendChild(div);
            });
            
            // Atualizar dificuldade visual
            atualizarDificuldadeVisual(pergunta.nivel_dificuldade);
        }

        function atualizarDificuldadeVisual(nivel) {
            const elemento = document.getElementById('dificuldade');
            const cores = {
                1: '#4CAF50',
                2: '#8BC34A',
                3: '#FFC107',
                4: '#FF9800',
                5: '#F44336'
            };
            
            const textos = {
                1: 'INICIANTE',
                2: 'F√ÅCIL',
                3: 'M√âDIO',
                4: 'DIF√çCIL',
                5: 'MESTRE'
            };
            
            elemento.style.background = `rgba(${hexToRgb(cores[nivel])}, 0.15)`;
            elemento.style.borderColor = `rgba(${hexToRgb(cores[nivel])}, 0.3)`;
            elemento.style.color = cores[nivel];
            elemento.innerHTML = `N√çVEL ${nivel}: <span style="color: ${cores[nivel]}; font-weight: bold;">${textos[nivel]}</span>`;
        }

        function hexToRgb(hex) {
            const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            return result ? `${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}` : null;
        }

        function selecionarOpcao(index) {
            // Se j√° selecionou e mostrou resultado, n√£o fazer nada
            if (estado.respostaCorreta !== null) return;
            
            const pergunta = estado.perguntas[estado.perguntaAtual];
            const opcoes = document.querySelectorAll('.opcao');
            
            // Remover sele√ß√£o anterior
            opcoes.forEach(op => {
                op.classList.remove('selecionada');
                op.classList.remove('correta');
                op.classList.remove('errada');
            });
            
            // Marcar como selecionada
            opcoes[index].classList.add('selecionada');
            estado.respostaSelecionada = index;
            
            // Verificar se acertou
            const acertou = (index === pergunta.resposta_correta - 1);
            
            // Mostrar feedback visual
            setTimeout(() => {
                // Marcar correta
                opcoes[pergunta.resposta_correta - 1].classList.add('correta');
                
                // Se errou, marcar como errada
                if (!acertou && index !== pergunta.resposta_correta - 1) {
                    opcoes[index].classList.add('errada');
                }
                
                // Atualizar pontos
                if (acertou) {
                    estado.pontos += pergunta.nivel_dificuldade * 15;
                    document.getElementById('pontos').textContent = estado.pontos;
                    
                    // Efeito de pontos
                    criarEfeitoPontos(opcoes[index], pergunta.nivel_dificuldade * 15);
                }
                
                estado.respostaCorreta = pergunta.resposta_correta - 1;
                
                // Habilitar bot√£o pr√≥ximo
                document.getElementById('btn-proximo').disabled = false;
                
            }, 500);
        }

        function criarEfeitoPontos(elemento, pontos) {
            const efeito = document.createElement('div');
            efeito.textContent = `+${pontos}`;
            efeito.style.position = 'absolute';
            efeito.style.color = '#4CAF50';
            efeito.style.fontWeight = 'bold';
            efeito.style.fontSize = '1.2rem';
            efeito.style.textShadow = '0 0 5px rgba(76, 175, 80, 0.8)';
            efeito.style.animation = 'floatUp 1s ease-out forwards';
            efeito.style.pointerEvents = 'none';
            efeito.style.zIndex = '100';
            
            const rect = elemento.getBoundingClientRect();
            efeito.style.left = `${rect.left + rect.width/2}px`;
            efeito.style.top = `${rect.top}px`;
            
            document.body.appendChild(efeito);
            
            // Adicionar estilo de anima√ß√£o
            const style = document.createElement('style');
            style.textContent = `
                @keyframes floatUp {
                    0% { opacity: 1; transform: translateY(0) scale(1); }
                    100% { opacity: 0; transform: translateY(-50px) scale(1.5); }
                }
            `;
            document.head.appendChild(style);
            
            // Remover ap√≥s anima√ß√£o
            setTimeout(() => {
                efeito.remove();
                style.remove();
            }, 1000);
        }

        function proximaPergunta() {
            estado.perguntaAtual++;
            mostrarPerguntaAtual();
        }

        // ============================================
        // FINALIZA√á√ÉO E RESULTADO
        // ============================================
        async function finalizarQuiz() {
            console.log("üèÅ Finalizando quiz...");
            document.getElementById('quiz-box').style.display = 'none';
            
            // Calcular porcentagem
            const maxPontos = estado.perguntas.reduce((acc, p) => acc + (p.nivel_dificuldade * 15), 0);
            const porcentagem = (estado.pontos / maxPontos) * 100;
            
            // Determinar Pombagira baseada na pontua√ß√£o e perfil
            estado.pombagiraResultado = determinarPombagiraResultado(porcentagem);
            estado.dadosPombagira = estado.pombagiraResultado;
            
            // Salvar resultado
            if (!estado.modoDemonstracao) {
                await salvarResultadoQuiz(estado.pombagiraResultado.id);
            }
            
            // Mostrar resultado
            mostrarResultado();
            
            // Atualizar contador
            await atualizarContador(true);
        }

        function determinarPombagiraResultado(porcentagem) {
            console.log(`üéØ Determinando Pombagira para ${porcentagem.toFixed(1)}% de acerto`);
            
            // Mapeamento baseado na pontua√ß√£o e perfil
            if (porcentagem >= 90) {
                // Excelente - Pombagiras de comando e sabedoria
                return estado.pombagiras.find(p => p.nome === "Maria Padilha") || estado.pombagiras[0];
            } else if (porcentagem >= 75) {
                // Bom - Pombagiras de prote√ß√£o e justi√ßa
                const opcoes = estado.pombagiras.filter(p => 
                    p.nome === "Maria Quit√©ria" || 
                    p.nome === "Rosa Caveira" ||
                    p.nome === "Dama da Noite"
                );
                return opcoes[Math.floor(Math.random() * opcoes.length)] || estado.pombagiras[1];
            } else if (porcentagem >= 50) {
                // M√©dio - Pombagiras de cura e equil√≠brio
                const opcoes = estado.pombagiras.filter(p => 
                    p.nome === "Maria Mulambo" || 
                    p.nome === "Pombagira da Praia" ||
                    p.nome === "Sete Saias"
                );
                return opcoes[Math.floor(Math.random() * opcoes.length)] || estado.pombagiras[2];
            } else if (porcentagem >= 30) {
                // B√°sico - Pombagiras de transforma√ß√£o
                const opcoes = estado.pombagiras.filter(p => 
                    p.nome === "Maria Farrapo" || 
                    p.nome === "Pombagira da Figueira" ||
                    p.nome === "Pombagira Cigana"
                );
                return opcoes[Math.floor(Math.random() * opcoes.length)] || estado.pombagiras[3];
            } else {
                // Iniciante - Pombagiras de renova√ß√£o
                const opcoes = estado.pombagiras.filter(p => 
                    p.nome === "Pombagira Menina" || 
                    p.nome === "Maria Navalha"
                );
                return opcoes[Math.floor(Math.random() * opcoes.length)] || estado.pombagiras[4];
            }
        }

        async function salvarResultadoQuiz(pombagiraId) {
            try {
                console.log("üíæ Salvando resultado...");
                
                const resultadoData = {
                    session_id: 'quiz_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),
                    pombagira_resultado: pombagiraId,
                    score: estado.pontos
                };
                
                console.log("üì§ Enviando:", resultadoData);
                
                const response = await fetch(SUPABASE_URL + '/rest/v1/resultados', {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': 'Bearer ' + SUPABASE_KEY,
                        'Content-Type': 'application/json',
                        'Prefer': 'return=minimal'
                    },
                    body: JSON.stringify(resultadoData)
                });
                
                if (response.ok) {
                    console.log("‚úÖ Resultado salvo!");
                } else {
                    const errorText = await response.text();
                    console.warn("‚ö†Ô∏è Erro ao salvar:", errorText);
                }
                
            } catch (error) {
                console.warn("‚ö†Ô∏è N√£o foi poss√≠vel salvar resultado:", error.message);
            }
        }

        function mostrarResultado() {
            const pombagira = estado.dadosPombagira;
            
            // Atualizar elementos
            document.getElementById('nome-pombagira').textContent = pombagira.nome;
            document.getElementById('frase-pombagira').textContent = `"${pombagira.frase_assinatura || 'Que os caminhos se abram para voc√™!'}"`;
            document.getElementById('pontuacao-final').textContent = estado.pontos;
            
            // Carregar imagem
            const imagemUrl = IMAGENS_POMBAGIRAS[pombagira.nome] || pombagira.imagem_url;
            if (imagemUrl) {
                document.getElementById('imagem-pombagira').src = imagemUrl;
                document.getElementById('imagem-pombagira').alt = pombagira.nome;
            }
            
            // Criar detalhes
            const detalhesContainer = document.getElementById('detalhes-pombagira');
            detalhesContainer.innerHTML = '';
            
            const detalhes = [
                { label: 'Comando', valor: pombagira.comandos, icone: 'fas fa-crown' },
                { label: 'Dia de Rever√™ncia', valor: pombagira.dia_reverencia, icone: 'fas fa-calendar-alt' },
                { label: 'Fase Lunar', valor: pombagira.fase_lua, icone: 'fas fa-moon' },
                { label: 'Cores Sagradas', valor: pombagira.cores ? pombagira.cores.join(', ') : null, icone: 'fas fa-palette' },
                { label: 'Calunga', valor: pombagira.calunga, icone: 'fas fa-crossroads' },
                { label: 'Oferendas', valor: pombagira.oferendas ? pombagira.oferendas.slice(0, 3).join(', ') : null, icone: 'fas fa-gift' }
            ];
            
            detalhes.forEach(detalhe => {
                if (detalhe.valor) {
                    const div = document.createElement('div');
                    div.className = 'detalhe-item';
                    div.innerHTML = `
                        <div class="detalhe-label">
                            <i class="${detalhe.icone}"></i> ${detalhe.label}:
                        </div>
                        <div class="detalhe-valor">${detalhe.valor}</div>
                    `;
                    detalhesContainer.appendChild(div);
                }
            });
            
            // Adicionar descri√ß√£o se dispon√≠vel
            if (pombagira.descricao) {
                const descDiv = document.createElement('div');
                descDiv.className = 'detalhe-item';
                descDiv.style.gridColumn = '1 / -1';
                descDiv.innerHTML = `
                    <div class="detalhe-label">
                        <i class="fas fa-scroll"></i> Sabedoria:
                    </div>
                    <div class="detalhe-valor" style="font-style: italic; line-height: 1.5;">${pombagira.descricao}</div>
                `;
                detalhesContainer.appendChild(descDiv);
            }
            
            // Mostrar resultado com anima√ß√£o
            document.getElementById('resultado').style.display = 'block';
            
            // Scroll para resultado
            setTimeout(() => {
                document.getElementById('resultado').scrollIntoView({ behavior: 'smooth' });
            }, 100);
        }

        function reiniciarQuiz() {
            // Resetar estado
            estado.perguntaAtual = 0;
            estado.pontos = 0;
            estado.respostas = [];
            estado.respostaSelecionada = null;
            estado.respostaCorreta = null;
            estado.pombagiraResultado = null;
            estado.dadosPombagira = null;
            
            // Embaralhar perguntas novamente
            if (!estado.modoDemonstracao && estado.perguntas.length > 0) {
                estado.perguntas = embaralharPerguntasComplexo(estado.perguntas);
            }
            
            // Esconder resultado, mostrar quiz
            document.getElementById('resultado').style.display = 'none';
            document.getElementById('quiz-box').style.display = 'block';
            
            // Mostrar primeira pergunta
            mostrarPerguntaAtual();
            
            // Scroll para topo
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function compartilharResultado() {
            const pombagira = estado.dadosPombagira;
            const texto = `Acabei de descobrir minha Pombagira protetora no Quiz Avan√ßado das 12 Pombagiras!\n\nüåô Minha Pombagira: ${pombagira.nome}\nüìú ${pombagira.frase_assinatura}\nüéØ Pontua√ß√£o: ${estado.pontos} pontos\n\nFa√ßa o quiz voc√™ tamb√©m!`;
            
            if (navigator.share) {
                navigator.share({
                    title: 'Minha Pombagira Protetora',
                    text: texto,
                    url: window.location.href
                });
            } else {
                // Fallback para copiar
                navigator.clipboard.writeText(texto + '\n\n' + window.location.href)
                    .then(() => alert('Resultado copiado para a √°rea de transfer√™ncia!'))
                    .catch(err => console.error('Erro ao copiar:', err));
            }
        }

        function mostrarErro(mensagem) {
            const errorDiv = document.getElementById('error-msg');
            errorDiv.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${mensagem}`;
            errorDiv.style.display = 'block';
            setTimeout(() => errorDiv.style.display = 'none', 5000);
        }

        // ============================================
        // INICIALIZA√á√ÉO
        // ============================================
        console.log("‚ú® Quiz Avan√ßado das 12 Pombagiras carregado!");
        console.log("üîó Supabase conectado");
        console.log("üé® Interface premium ativa");
        console.log("üé≤ Sistema de embaralhamento complexo pronto");
        
        // Carregar contador inicial
        carregarContador();
        
        // Atualizar contador periodicamente
        setInterval(() => atualizarContador(true), 5 * 60 * 1000);
    </script>
</body>
</html>
